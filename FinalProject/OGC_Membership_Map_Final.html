<!DOCTYPE html>
<html>
<head>

	<title>OGC Membership Map</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">


		<link rel="stylesheet" type="text/css" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
		<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.css" />
		<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.Default.css" />

		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

		<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js'></script>
    <script type='text/javascript' src='http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js'></script>
    <script type='text/javascript' src='http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/leaflet.markercluster.js'></script>


	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		#map {
			width: 1000px;
			height: 600px;
		}
	</style>


</head>
<body>

<div id='map'></div>

<script src=".\OGC_Membership.js" type="text/javascript"></script>

<script>


/* WMS Basemap Layers */

			var wmsLayer = L.tileLayer.wms('https://demo.boundlessgeo.com/geoserver/ows?', {
			    layers: 'ne:ne'
			});


			var wmsLayer2 = L.tileLayer.wms('https://demo.boundlessgeo.com/geoserver/ows?', {
			    layers: 'nasa:bluemarble'
			});




/* Basemap grouping for layer control/legend */

			var baseLayers = {
					"Basemap": wmsLayer,
					"Aerial": wmsLayer2
			};




/* Initiate map, define initial center point and zoom level */

			var map = L.map('map', {
					center: [0, 0],
					zoom: 2,
					layers: [wmsLayer]
				});




/* Creates style and popup function */

			function onEachFeature(feature, layer) {
				var popupContent = "<p><b>Name: </b>" +
						feature.properties.Name + "<br/><b>Org Type: </b>" +
						feature.properties.OrgType + "<br/><b>Level: </b>" +
						feature.properties.Level + "</p>";

				if (feature.properties && feature.properties.popupContent) {
					popupContent += feature.properties.popupContent;
				}

				layer.bindPopup(popupContent);
			}


			var stylePoint = {
						radius: 4,
						fillColor: "#0058ff",
						color: "#000",
						weight: 1,
						opacity: 1,
						fillOpacity: 0.8
			};

			function pointToLayer (feature, latlng) {
				return L.circleMarker(latlng, stylePoint);
			}




/* Creates full membership layer with style and popup */

			membersLayer =  L.geoJson(OGCMembers, {

				style: function (feature) {
					return feature.properties && feature.properties.style;
				},

				onEachFeature: onEachFeature,
				pointToLayer: pointToLayer

			});




/* Creates all of the map layers using style and popup function above and filter functions below */

			var luni = L.geoJson (OGCMembers, {filter:luniFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lgovf = L.geoJson (OGCMembers, {filter:lgovfFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ltech = L.geoJson (OGCMembers, {filter:ltechFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lassoc = L.geoJson (OGCMembers, {filter:lassocFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lstrat = L.geoJson (OGCMembers, {filter:lstratFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lprin = L.geoJson (OGCMembers, {filter:lprinFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ltechagg = L.geoJson (OGCMembers, {filter:ltechaggFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lsmallcomp = L.geoJson (OGCMembers, {filter:lsmallcompFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lgovs = L.geoJson (OGCMembers, {filter:lgovsFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lgovl = L.geoJson (OGCMembers, {filter:lgovlFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lind = L.geoJson (OGCMembers, {filter:lindFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var lother = L.geoJson (OGCMembers, {filter:lotherFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ouni = L.geoJson (OGCMembers, {filter:ouniFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ogovn = L.geoJson (OGCMembers, {filter:ogovnFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ocom = L.geoJson (OGCMembers, {filter:ocomFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ogovl = L.geoJson (OGCMembers, {filter:ogovlFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ogovs = L.geoJson (OGCMembers, {filter:ogovsFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var ogovi = L.geoJson (OGCMembers, {filter:ogoviFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var oind = L.geoJson (OGCMembers, {filter:oindFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});
			var oother = L.geoJson (OGCMembers, {filter:ootherFilter,onEachFeature: onEachFeature,pointToLayer: pointToLayer});



/* Filter functions for each facet */

			function luniFilter (feature){ if (feature.properties.Level === 'University') return true; }
			function lgovfFilter (feature){ if (feature.properties.Level === 'GovFuture-Local') return true; }
			function ltechFilter (feature){ if (feature.properties.Level === 'Technical') return true; }
			function lassocFilter (feature){ if (feature.properties.Level === 'Associate') return true; }
			function lotherFilter (feature){ if (feature.properties.Level === 'NGO') return true; }
			function lstratFilter (feature){ if (feature.properties.Level === 'Strategic') return true; }
			function lprinFilter (feature){ if (feature.properties.Level === 'Principal') return true; }
			function ltechaggFilter (feature){ if (feature.properties.Level === 'Technical Aggregate') return true; }
			function lsmallcompFilter (feature){ if (feature.properties.Level === 'Small Company') return true; }
			function lgovsFilter (feature){ if (feature.properties.Level === 'Government-Subnational') return true; }
			function lgovlFilter (feature){ if (feature.properties.Level === 'Government-Local') return true; }
			function lindFilter (feature){ if (feature.properties.Level === 'Individual') return true; }
			function ouniFilter (feature){ if (feature.properties.OrgType === 'University') return true; }
			function ogovnFilter (feature){ if (feature.properties.OrgType === 'Government-National') return true; }
			function ocomFilter (feature){ if (feature.properties.OrgType === 'Commercial') return true; }
			function ogovlFilter (feature){ if (feature.properties.OrgType === 'Government-Local') return true; }
			function ogovsFilter (feature){ if (feature.properties.OrgType === 'Government-Subnational') return true; }
			function ogoviFilter (feature){ if (feature.properties.OrgType === 'Government-International') return true; }
			function oindFilter (feature){ if (feature.properties.OrgType === 'Individual') return true; }
			function ootherFilter (feature){ if (feature.properties.OrgType === 'NGO') return true; }





/* Cluster settings and marker cluster grouping */

			var clusterSettings = {
					maxClusterRadius : 50,
					};


			var markerClusters1 = L.markerClusterGroup(clusterSettings);
			var markerClustersl1 = L.markerClusterGroup(clusterSettings);
			var markerClustersl2 = L.markerClusterGroup(clusterSettings);
			var markerClustersl3 = L.markerClusterGroup(clusterSettings);
			var markerClustersl4 = L.markerClusterGroup(clusterSettings);
			var markerClustersl5 = L.markerClusterGroup(clusterSettings);
			var markerClustersl6 = L.markerClusterGroup(clusterSettings);
			var markerClustersl7 = L.markerClusterGroup(clusterSettings);
			var markerClustersl8 = L.markerClusterGroup(clusterSettings);
			var markerClustersl9 = L.markerClusterGroup(clusterSettings);
			var markerClustersl10 = L.markerClusterGroup(clusterSettings);
			var markerClustersl11 = L.markerClusterGroup(clusterSettings);
			var markerClustersl12 = L.markerClusterGroup(clusterSettings);
			var markerClusterso1 = L.markerClusterGroup(clusterSettings);
			var markerClusterso2 = L.markerClusterGroup(clusterSettings);
			var markerClusterso3 = L.markerClusterGroup(clusterSettings);
			var markerClusterso4 = L.markerClusterGroup(clusterSettings);
			var markerClusterso5 = L.markerClusterGroup(clusterSettings);
			var markerClusterso6 = L.markerClusterGroup(clusterSettings);
			var markerClusterso7 = L.markerClusterGroup(clusterSettings);
			var markerClusterso8 = L.markerClusterGroup(clusterSettings);




/* All overlays (non-basemap layers) that will appear in the layer control interface must appear together in a variable */

			var overlays = {
						"All OGC Members" : markerClusters1.addLayer(membersLayer),
						"Level: Associate" : markerClustersl1.addLayer(lassoc),
						"Level: GovFuture-Local" : markerClustersl2.addLayer(lgovf),
						"Level: Technical" : markerClustersl3.addLayer(ltech),
						"Level: University" : markerClustersl4.addLayer(luni),
						"Level: Individual" : markerClustersl5.addLayer(lind),
						"Level: Strategic" : markerClustersl6.addLayer(lstrat),
						"Level: Principal" : markerClustersl7.addLayer(lprin),
						"Level: Technical Aggregate" : markerClustersl8.addLayer(ltechagg),
						"Level: Small Company" : markerClustersl9.addLayer(lsmallcomp),
						"Level: Government-Subnational" : markerClustersl10.addLayer(lgovs),
						"Level: Government-Local" : markerClustersl11.addLayer(lgovl),
						"Level: NGO" : markerClustersl12.addLayer(lother),
						"Org Type: Commercial" : markerClusterso1.addLayer(ocom),
						"Org Type: Government-Local" : markerClusterso2.addLayer(ogovl),
						"Org Type: Government-Subnational" : markerClusterso3.addLayer(ogovs),
						"Org Type: Government-National" : markerClusterso4.addLayer(ogovn),
						"Org Type: Government-International" : markerClusterso5.addLayer(ogovi),
						"Org Type: Individual" : markerClusterso6.addLayer(oind),
						"Org Type: University" : markerClusterso7.addLayer(ouni),
						"Org Type: NGO" : markerClusterso8.addLayer(oother)
			};





/* Adds Layer Control interface to the map */

			var layerControl = L.control.layers(baseLayers, overlays, {collapsed : false, position : 'topright'});
			map.addControl(layerControl);




/* Creates popup layer and adds an on click function for position to it */

			var popup = L.popup();


			function onMapClick(e) {
			    popup
			        .setLatLng(e.latlng)
			        .setContent("You clicked the map at " + e.latlng.toString())
			        .openOn(map);
			}

			map.on('click', onMapClick);

</script>



</body>
</html>
