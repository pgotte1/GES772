<!DOCTYPE html>
<html>
<head>

	<title>OGC Membership Map</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">


		<link rel="stylesheet" type="text/css" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
		<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.css" />
		<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.Default.css" />

		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

		<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js'></script>
    <script type='text/javascript' src='http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js'></script>
    <script type='text/javascript' src='http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/leaflet.markercluster.js'></script>


	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		#map {
			width: 1000px;
			height: 600px;
		}
	</style>


</head>
<body>

<div id='map'></div>

<script src="E:\GES772\Project\OGC_Membership.js" type="text/javascript"></script>

<script>


	/*Map attribution */
	var mapboxAttri = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
				'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		mapboxUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2hoNSIsImEiOiJjamVnZDJsOGQyZHNmMndxZTlqNnhlYW50In0.FC9oeiu5qtD9o19qjlfkMg';

	/* Use Leaflet base layers */
	var grayscale   = L.tileLayer(mapboxUrl, {id: 'mapbox.light', attribution: mapboxAttri}),
			streets  = L.tileLayer(mapboxUrl, {id: 'mapbox.streets',   attribution: mapboxAttri});
	var baseLayers = {
			"Grayscale": grayscale,
			"Streets": streets
	};

	/*Initiate map, define initial center point and zoom level */
	var map = L.map('map', {
			center: [0, 0],
			zoom: 2,
			layers: [grayscale]
		});


	function onEachFeature(feature, layer) {
		var popupContent = "<p><b>Name: </b>" +
				feature.properties.Name + "<br/><b>Org Type: </b>" +
				feature.properties.OrgType + "<br/><b>Level: </b>" +
				feature.properties.Level + "</p>";

		if (feature.properties && feature.properties.popupContent) {
			popupContent += feature.properties.popupContent;
		}

		layer.bindPopup(popupContent);
	}

	membersLayer =  L.geoJson(OGCMembers, {

		style: function (feature) {
			return feature.properties && feature.properties.style;
		},

		onEachFeature: onEachFeature,

		pointToLayer: function (feature, latlng) {
			return L.circleMarker(latlng, {
				radius: 4,
				fillColor: "#0058ff",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.8
			});
		}

	});
	/* .addTo(map); */

/*	var style = {
		radius: 4,
		fillColor: "#0058ff",
		color: "#000",
		weight: 1,
		opacity: 1,
		fillOpacity: 0.8
	}; */


	var luni = L.layerGroup();
	var lgovf = L.layerGroup();
	var ltech = L.layerGroup();
	var lassoc = L.layerGroup();
	var lother = L.layerGroup();
	var lstrat = L.layerGroup();
	var lprin = L.layerGroup();
	var ltechagg = L.layerGroup();
	var lsmallcomp = L.layerGroup();
	var lgovs = L.layerGroup();
	var lgovl = L.layerGroup();
	var lind = L.layerGroup();
	var ocom = L.layerGroup();
	var ogovl = L.layerGroup();
	var ogovs = L.layerGroup();
	var oind = L.layerGroup();
	var oother = L.layerGroup();


	levelLayer = L.geoJson(OGCMembers, {
		    onEachFeature: function(feature, layer) {


		        if (feature.properties.Level == 'University') {
		            layer.addTo(luni);
		        } else
						if (feature.properties.Level == 'GovFuture-Local') {
		            layer.addTo(lgovf);
		        } else
						if (feature.properties.Level == 'Technical') {
		        		layer.addTo(ltech);
		        } else
						if (feature.properties.Level == 'Associate') {
		        		layer.addTo(lassoc);
		        } else
						if (feature.properties.Level == 'Strategic') {
		        		layer.addTo(lstrat);
		        } else
						if (feature.properties.Level == 'Principal') {
		        		layer.addTo(lprin);
		        } else
						if (feature.properties.Level == 'Technical Aggregate') {
		        		layer.addTo(ltechagg);
		        } else
						if (feature.properties.Level == 'Small Company') {
		        		layer.addTo(lsmallcomp);
		        } else
						if (feature.properties.Level == 'Government-Local') {
		        		layer.addTo(lgovl);
		        } else
						if (feature.properties.Level == 'Government-Subnational') {
		        		layer.addTo(lgovs);
		        } else
						if (feature.properties.Level == 'Individual') {
		        		layer.addTo(lind);
		        } else {
								layer.addTo(lother);
						}

		        }
		});

		orgLayer = L.geoJson(OGCMembers, {
			    onEachFeature: function(feature, layer) {

							if (feature.properties["Org Type"] == 'Commercial') {
			        		layer.addTo(ocom);
							} else
							if (feature.properties["Org Type"] == 'Government-Local') {
			        		layer.addTo(ogovl);
							} else
							if (feature.properties["Org Type"] == 'Government-Subnational') {
			        		layer.addTo(ogovs);
							} else
							if (feature.properties["Org Type"] == 'Individual') {
			        		layer.addTo(oind);
							} else {
									layer.addTo(oother);
							}

			        }
			});

			var clusterSettings = {
					maxClusterRadius : 50,
					};


			var markerClusters1 = L.markerClusterGroup(clusterSettings);
			var markerClustersl1 = L.markerClusterGroup(clusterSettings);
			var markerClustersl2 = L.markerClusterGroup(clusterSettings);
			var markerClustersl3 = L.markerClusterGroup(clusterSettings);
			var markerClustersl4 = L.markerClusterGroup(clusterSettings);
			var markerClustersl5 = L.markerClusterGroup(clusterSettings);
			var markerClustersl6 = L.markerClusterGroup(clusterSettings);
			var markerClustersl7 = L.markerClusterGroup(clusterSettings);
			var markerClustersl8 = L.markerClusterGroup(clusterSettings);
			var markerClustersl9 = L.markerClusterGroup(clusterSettings);
			var markerClustersl10 = L.markerClusterGroup(clusterSettings);
			var markerClustersl11 = L.markerClusterGroup(clusterSettings);
			var markerClustersl12 = L.markerClusterGroup(clusterSettings);
			var markerClusterso1 = L.markerClusterGroup(clusterSettings);
			var markerClusterso2 = L.markerClusterGroup(clusterSettings);
			var markerClusterso3 = L.markerClusterGroup(clusterSettings);
			var markerClusterso4 = L.markerClusterGroup(clusterSettings);
			var markerClusterso5 = L.markerClusterGroup(clusterSettings);


	/* All overlays (non-basemap layers) that will appear in the layer control interface must appear
   together in a variable */
	var overlays = {
//		"Members" : memberLayer,
		"All OGC Members" : markerClusters1.addLayer(membersLayer),
		"Level: Associate" : markerClustersl1.addLayer(lassoc),
		"Level: GovFuture-Local" : markerClustersl2.addLayer(lgovf),
		"Level: Technical" : markerClustersl3.addLayer(ltech),
		"Level: University" : markerClustersl4.addLayer(luni),
		"Level: NGO" : markerClustersl5.addLayer(lother),
		"Level: Strategic" : markerClustersl6.addLayer(lstrat),
		"Level: Principal" : markerClustersl7.addLayer(lprin),
		"Level: Technical Aggregate" : markerClustersl8.addLayer(ltechagg),
		"Level: Small Company" : markerClustersl9.addLayer(lsmallcomp),
		"Level: Government-Subnational" : markerClustersl10.addLayer(lgovs),
		"Level: Government-Local" : markerClustersl11.addLayer(lgovl),
		"Level: Individual" : markerClustersl12.addLayer(lind),
		"Org Type: Commercial" : markerClusterso1.addLayer(ocom),
		"Org Type: Government-Local" : markerClusterso2.addLayer(ogovl),
		"Org Type: Government-Subnational" : markerClusterso3.addLayer(ogovs),
		"Org Type: Individual" : markerClusterso4.addLayer(oind),
		"Org Type: Other" : markerClusterso5.addLayer(oother)
	};

	/*Adds Layer Control interface to the map */
	var layerControl = L.control.layers(baseLayers, overlays, {collapsed : false, position : 'topright'});
	map.addControl(layerControl);

	/*Creates popup layer and adds an on click function for position to it */
	var popup = L.popup();


	function onMapClick(e) {
	    popup
	        .setLatLng(e.latlng)
	        .setContent("You clicked the map at " + e.latlng.toString())
	        .openOn(map);
	}

	map.on('click', onMapClick);

</script>



</body>
</html>
